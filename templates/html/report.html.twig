<html>
<head>
    <title>PhpMetrics report</title>
    <meta charset="utf-8">

    <style type="text/css">
        {% include "assets/bootstrap.css.twig" %}
    </style>
</head>

<body>

<div class="container">
    <h1>PhpMetrics report</h1>

    <div class="row col-sm-6">
        <h2>Maintenability</h2>
        <small><a id="btn-save-maintenability" download="phpmetric-bubbles.svg">Download (as SVG)</a></small>
        <div id="svg-maintenability"></div>
    </div>
    <div class="row col-sm-6">
        <h2>Custom chart</h2>
        <small><a id="btn-save-custom" download="phpmetric-custom.svg">Download (as SVG)</a></small>


        <table class="table table-condensed table-bordered">
            <tr>
                <td>X Axis</td>
                <td>Y Axis</td>
                <td>Diameter</td>
            </tr>
            <tr>
                <td>
                    <select id="xAxis" class="form-control" onchange="xAxis = this.value; updateCustomChart();">
                        {% for key in keys|sort %}
                            <option value="{{key}}">{{key|textify}} </option>
                        {% endfor %}
                    </select>
                </td>
                <td>
                    <select id="yAxis" class="form-control" onchange="yAxis = this.value; updateCustomChart();">
                        {% for key in keys|sort %}
                            <option value="{{key}}">{{key|textify}} </option>
                        {% endfor %}
                    </select>
                </td>
                <td>
                    <select id="rAxis" class="form-control" onchange="rAxis = this.value; updateCustomChart();">
                        {% for key in keys|sort %}
                            <option value="{{key}}">{{key|textify}} </option>
                        {% endfor %}
                    </select>
                </td>
            </tr>
        </table>

        <div id="svg-custom"></div>
    </div>




    <h2>Stats</h2>

    <table class="table table-striped table-condensed">
        <thead>
            <th></th>
            <th>Min</th>
            <th>Max</th>
            <th>Average</th>
            <th>Sum</th>
        </thead>
        <tbody>
            <tr>
                <th>LLOC</th>
                <td>{{boundaries.getMin('logicalLoc')}}</td>
                <td>{{boundaries.getMax('logicalLoc')}}</td>
                <td>{{boundaries.getAverage('logicalLoc')|round}}</td>
                <td>{{boundaries.getSum('logicalLoc')|round}}</td>
            </tr>
            <tr>
                <th>Complexity</th>
                <td>{{boundaries.getMin('cyclomaticComplexity')|round}}</td>
                <td>{{boundaries.getMax('cyclomaticComplexity')|round}}</td>
                <td>{{boundaries.getAverage('cyclomaticComplexity')|round}}</td>
                <td>{{boundaries.getSum('cyclomaticComplexity')|round}}</td>
            </tr>
            <tr>
                <th>Maintenability index</th>
                <td>{{boundaries.getMin('maintenabilityIndex')|round }}</td>
                <td>{{boundaries.getMax('maintenabilityIndex')|round }}</td>
                <td>{{boundaries.getAverage('maintenabilityIndex')|round }}</td>
                <td>{{boundaries.getSum('maintenabilityIndex')|round }}</td>
            </tr>
            <tr>
                <th>Difficulty</th>
                <td>{{boundaries.getMin('difficulty')|round}}</td>
                <td>{{boundaries.getMax('difficulty')|round}}</td>
                <td>{{boundaries.getAverage('difficulty')|round}}</td>
                <td>{{boundaries.getSum('difficulty')|round}}</td>
            </tr>
            <tr>
                <th>Volume</th>
                <td>{{boundaries.getMin('volume')|round}}</td>
                <td>{{boundaries.getMax('volume')|round}}</td>
                <td>{{boundaries.getAverage('volume')|round}}</td>
                <td>{{boundaries.getSum('volume')|round}}</td>
            </tr>
            <tr>
                <th>Vocabulary</th>
                <td>{{boundaries.getMin('vocabulary')}}</td>
                <td>{{boundaries.getMax('vocabulary')}}</td>
                <td>{{boundaries.getAverage('vocabulary')|round}}</td>
                <td>{{boundaries.getSum('vocabulary')|round}}</td>
            </tr>
            <tr>
                <th>Comment weight</th>
                <td>{{boundaries.getMin('commentWeight')|round}}</td>
                <td>{{boundaries.getMax('commentWeight')|round}}</td>
                <td>{{boundaries.getAverage('commentWeight')|round}}</td>
                <td>{{boundaries.getSum('commentWeight')|round}}</td>
            </tr>
            <tr>
                <th>Intelligent content</th>
                <td>{{boundaries.getMin('intelligentContent')|round}}</td>
                <td>{{boundaries.getMax('intelligentContent')|round}}</td>
                <td>{{boundaries.getAverage('intelligentContent')|round}}</td>
                <td>{{boundaries.getSum('intelligentContent')|round}}</td>
            </tr>
        </tbody>
    </table>

    <h2>Details</h2>

    <table class="table table-striped table-condensed" id="table-results">
        <thead>
            <th>File</th>
            <th>LLOC</th>
            <th>Complexity</th>
            <th>Maintenability index</th>
            <th>Volume</th>
            <th>Vocabulary</th>
            <th>Comment weight</th>
            <th>Intelligent content</th>
            <th>Difficulty</th>
        </thead>
        <tbody>
        {% for result in results %}
            <tr>
                <td>{{result.filename}}</td>
                <td>{{result.logicalLoc}}</td>
                <td>{{result.cyclomaticComplexity}}</td>
                <td>{{result.maintenabilityIndex  |round }}</td>
                <td>{{result.volume |round }}</td>
                <td>{{result.vocabulary|round}}</td>
                <td>{{result.commentWeight|round}}</td>
                <td>{{result.intelligentContent|round}}</td>
                <td>{{result.difficulty|round}}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>


    <div>
        Powered by <a href="https://github.com/Halleck45/PhpMetrics">PhpMetrics</a> - Copyright Jean-François Lépine
    </div>


</div>






{% include "assets/d3js.js.twig" %}
{% include "assets/jquery.js.twig" %}
{% include "assets/tablesorter.js.twig" %}
{% include "report-maintenability.js.twig" %}
{% include "report-custom.js.twig" %}


<script type="text/javascript">
    $(function(){
        $("#table-results").tablesorter();
        updateCustomChart();
        updateMaintenablityChart();

        // selects
        $('#xAxis').val(xAxis);
        $('#yAxis').val(yAxis);
        $('#rAxis').val(rAxis);
    });

    // default selected elements
    var xAxis = 'intelligentContent';
    var yAxis = 'cyclomaticComplexity';
    var rAxis = 'loc';

    /**
     * Update custom chart
     */
    function updateCustomChart() {
        chartCustom(xAxis, yAxis, rAxis);
        var svg  = document.getElementById('svg-custom').childNodes[0],
        xml  = new XMLSerializer().serializeToString(svg),
        data = btoa(xml),
        img  = new Image();
        $('#btn-save-custom').attr('href', 'data:application/octet-stream;base64,' + data)
    };

    /**
     * Update maintenability chart (bubbles)
     */
    function updateMaintenablityChart() {
        chartMaintenability(xAxis, yAxis, rAxis);
        var svg  = document.getElementById('svg-maintenability').childNodes[0],
                xml  = new XMLSerializer().serializeToString(svg),
                data = btoa(xml),
                img  = new Image();
        $('#btn-save-maintenability').attr('href', 'data:application/octet-stream;base64,' + data)
    };

    /**
     * string as readable text
     *
     * @param string
     * @returns {XML|string|void}
     */
    function textify(string) {
        string = string.charAt(0).toUpperCase() + string.slice(1);
        return string.replace(/([a-z0-9])([A-Z])/, "$1 $2");
    }

    {% autoescape false %}
    var data = {{ results | json_encode }}
    {% endautoescape %}
</script>


</body>
</html>